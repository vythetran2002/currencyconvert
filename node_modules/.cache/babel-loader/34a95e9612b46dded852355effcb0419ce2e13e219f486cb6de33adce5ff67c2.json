{"ast":null,"code":"// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n/**\n * @fileoverview Defines an environment agnostic {@linkplain cmd.Executor\n * command executor} that communicates with a remote end using JSON over HTTP.\n *\n * Clients should implement the {@link Client} interface, which is used by\n * the {@link Executor} to send commands to the remote end.\n */\n\n'use strict';\n\nconst path = require('path');\nconst cmd = require('./command');\nconst error = require('./error');\nconst logging = require('./logging');\nconst promise = require('./promise');\nconst {\n  Session\n} = require('./session');\nconst webElement = require('./webelement');\nconst {\n  isObject\n} = require('./util');\nconst getAttribute = requireAtom('get-attribute.js', '//javascript/node/selenium-webdriver/lib/atoms:get-attribute.js');\nconst isDisplayed = requireAtom('is-displayed.js', '//javascript/node/selenium-webdriver/lib/atoms:is-displayed.js');\nconst findElements = requireAtom('find-elements.js', '//javascript/node/selenium-webdriver/lib/atoms:find-elements.js');\n\n/**\n * @param {string} module\n * @param {string} bazelTarget\n * @return {!Function}\n */\nfunction requireAtom(module, bazelTarget) {\n  try {\n    return require('./atoms/' + module);\n  } catch (ex) {\n    try {\n      const file = bazelTarget.slice(2).replace(':', '/');\n      console.log(`../../../bazel-bin/${file}`);\n      return require(path.resolve(`../../../bazel-bin/${file}`));\n    } catch (ex2) {\n      console.log(ex2);\n      throw Error(`Failed to import atoms module ${module}. If running in dev mode, you` + ` need to run \\`bazel build ${bazelTarget}\\` from the project` + `root: ${ex}`);\n    }\n  }\n}\n\n/**\n * Converts a headers map to a HTTP header block string.\n * @param {!Map<string, string>} headers The map to convert.\n * @return {string} The headers as a string.\n */\nfunction headersToString(headers) {\n  const ret = [];\n  headers.forEach(function (value, name) {\n    ret.push(`${name.toLowerCase()}: ${value}`);\n  });\n  return ret.join('\\n');\n}\n\n/**\n * Represents a HTTP request message. This class is a \"partial\" request and only\n * defines the path on the server to send a request to. It is each client's\n * responsibility to build the full URL for the final request.\n * @final\n */\nclass Request {\n  /**\n   * @param {string} method The HTTP method to use for the request.\n   * @param {string} path The path on the server to send the request to.\n   * @param {Object=} opt_data This request's non-serialized JSON payload data.\n   */\n  constructor(method, path, opt_data) {\n    this.method = /** string */method;\n    this.path = /** string */path;\n    this.data = /** Object */opt_data;\n    this.headers = /** !Map<string, string> */new Map([['Accept', 'application/json; charset=utf-8']]);\n  }\n\n  /** @override */\n  toString() {\n    let ret = `${this.method} ${this.path} HTTP/1.1\\n`;\n    ret += headersToString(this.headers) + '\\n\\n';\n    if (this.data) {\n      ret += JSON.stringify(this.data);\n    }\n    return ret;\n  }\n}\n\n/**\n * Represents a HTTP response message.\n * @final\n */\nclass Response {\n  /**\n   * @param {number} status The response code.\n   * @param {!Object<string>} headers The response headers. All header names\n   *     will be converted to lowercase strings for consistent lookups.\n   * @param {string} body The response body.\n   */\n  constructor(status, headers, body) {\n    this.status = /** number */status;\n    this.body = /** string */body;\n    this.headers = /** !Map<string, string>*/new Map();\n    for (let header in headers) {\n      this.headers.set(header.toLowerCase(), headers[header]);\n    }\n  }\n\n  /** @override */\n  toString() {\n    let ret = `HTTP/1.1 ${this.status}\\n${headersToString(this.headers)}\\n\\n`;\n    if (this.body) {\n      ret += this.body;\n    }\n    return ret;\n  }\n}\n\n/** @enum {!Function} */\nconst Atom = {\n  GET_ATTRIBUTE: getAttribute,\n  IS_DISPLAYED: isDisplayed,\n  FIND_ELEMENTS: findElements\n};\nconst LOG = logging.getLogger('webdriver.http');\nfunction post(path) {\n  return resource('POST', path);\n}\nfunction del(path) {\n  return resource('DELETE', path);\n}\nfunction get(path) {\n  return resource('GET', path);\n}\nfunction resource(method, path) {\n  return {\n    method: method,\n    path: path\n  };\n}\n\n/** @typedef {{method: string, path: string}} */\nvar CommandSpec; // eslint-disable-line\n\n/** @typedef {function(!cmd.Command): !cmd.Command} */\nvar CommandTransformer; // eslint-disable-line\n\nclass InternalTypeError extends TypeError {}\n\n/**\n * @param {!cmd.Command} command The initial command.\n * @param {Atom} atom The name of the atom to execute.\n * @param params\n * @return {!Command} The transformed command to execute.\n */\nfunction toExecuteAtomCommand(command, atom, name) {\n  if (typeof atom !== 'function') {\n    throw new InternalTypeError('atom is not a function: ' + typeof atom);\n  }\n  for (var _len = arguments.length, params = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    params[_key - 3] = arguments[_key];\n  }\n  return new cmd.Command(cmd.Name.EXECUTE_SCRIPT).setParameter('sessionId', command.getParameter('sessionId')).setParameter('script', `/* ${name} */return (${atom}).apply(null, arguments)`).setParameter('args', params.map(param => command.getParameter(param)));\n}\n\n/** @const {!Map<string, (CommandSpec|CommandTransformer)>} */\nconst W3C_COMMAND_MAP = new Map([\n// Session management.\n[cmd.Name.NEW_SESSION, post('/session')], [cmd.Name.QUIT, del('/session/:sessionId')],\n// Server status.\n[cmd.Name.GET_SERVER_STATUS, get('/status')],\n// timeouts\n[cmd.Name.GET_TIMEOUT, get('/session/:sessionId/timeouts')], [cmd.Name.SET_TIMEOUT, post('/session/:sessionId/timeouts')],\n// Navigation.\n[cmd.Name.GET_CURRENT_URL, get('/session/:sessionId/url')], [cmd.Name.GET, post('/session/:sessionId/url')], [cmd.Name.GO_BACK, post('/session/:sessionId/back')], [cmd.Name.GO_FORWARD, post('/session/:sessionId/forward')], [cmd.Name.REFRESH, post('/session/:sessionId/refresh')],\n// Page inspection.\n[cmd.Name.GET_PAGE_SOURCE, get('/session/:sessionId/source')], [cmd.Name.GET_TITLE, get('/session/:sessionId/title')],\n// Script execution.\n[cmd.Name.EXECUTE_SCRIPT, post('/session/:sessionId/execute/sync')], [cmd.Name.EXECUTE_ASYNC_SCRIPT, post('/session/:sessionId/execute/async')],\n// Frame selection.\n[cmd.Name.SWITCH_TO_FRAME, post('/session/:sessionId/frame')], [cmd.Name.SWITCH_TO_FRAME_PARENT, post('/session/:sessionId/frame/parent')],\n// Window management.\n[cmd.Name.GET_CURRENT_WINDOW_HANDLE, get('/session/:sessionId/window')], [cmd.Name.CLOSE, del('/session/:sessionId/window')], [cmd.Name.SWITCH_TO_WINDOW, post('/session/:sessionId/window')], [cmd.Name.SWITCH_TO_NEW_WINDOW, post('/session/:sessionId/window/new')], [cmd.Name.GET_WINDOW_HANDLES, get('/session/:sessionId/window/handles')], [cmd.Name.GET_WINDOW_RECT, get('/session/:sessionId/window/rect')], [cmd.Name.SET_WINDOW_RECT, post('/session/:sessionId/window/rect')], [cmd.Name.MAXIMIZE_WINDOW, post('/session/:sessionId/window/maximize')], [cmd.Name.MINIMIZE_WINDOW, post('/session/:sessionId/window/minimize')], [cmd.Name.FULLSCREEN_WINDOW, post('/session/:sessionId/window/fullscreen')],\n// Actions.\n[cmd.Name.ACTIONS, post('/session/:sessionId/actions')], [cmd.Name.CLEAR_ACTIONS, del('/session/:sessionId/actions')], [cmd.Name.PRINT_PAGE, post('/session/:sessionId/print')],\n// Locating elements.\n[cmd.Name.GET_ACTIVE_ELEMENT, get('/session/:sessionId/element/active')], [cmd.Name.FIND_ELEMENT, post('/session/:sessionId/element')], [cmd.Name.FIND_ELEMENTS, post('/session/:sessionId/elements')], [cmd.Name.FIND_ELEMENTS_RELATIVE, cmd => {\n  return toExecuteAtomCommand(cmd, Atom.FIND_ELEMENTS, 'findElements', 'args');\n}], [cmd.Name.FIND_CHILD_ELEMENT, post('/session/:sessionId/element/:id/element')], [cmd.Name.FIND_CHILD_ELEMENTS, post('/session/:sessionId/element/:id/elements')],\n// Element interaction.\n[cmd.Name.GET_ELEMENT_TAG_NAME, get('/session/:sessionId/element/:id/name')], [cmd.Name.GET_DOM_ATTRIBUTE, get('/session/:sessionId/element/:id/attribute/:name')], [cmd.Name.GET_ELEMENT_ATTRIBUTE, cmd => {\n  return toExecuteAtomCommand(cmd, Atom.GET_ATTRIBUTE, 'getAttribute', 'id', 'name');\n}], [cmd.Name.GET_ELEMENT_PROPERTY, get('/session/:sessionId/element/:id/property/:name')], [cmd.Name.GET_ELEMENT_VALUE_OF_CSS_PROPERTY, get('/session/:sessionId/element/:id/css/:propertyName')], [cmd.Name.GET_ELEMENT_RECT, get('/session/:sessionId/element/:id/rect')], [cmd.Name.CLEAR_ELEMENT, post('/session/:sessionId/element/:id/clear')], [cmd.Name.CLICK_ELEMENT, post('/session/:sessionId/element/:id/click')], [cmd.Name.SEND_KEYS_TO_ELEMENT, post('/session/:sessionId/element/:id/value')], [cmd.Name.GET_ELEMENT_TEXT, get('/session/:sessionId/element/:id/text')], [cmd.Name.GET_COMPUTED_ROLE, get('/session/:sessionId/element/:id/computedrole')], [cmd.Name.GET_COMPUTED_LABEL, get('/session/:sessionId/element/:id/computedlabel')], [cmd.Name.IS_ELEMENT_ENABLED, get('/session/:sessionId/element/:id/enabled')], [cmd.Name.IS_ELEMENT_SELECTED, get('/session/:sessionId/element/:id/selected')], [cmd.Name.IS_ELEMENT_DISPLAYED, cmd => {\n  return toExecuteAtomCommand(cmd, Atom.IS_DISPLAYED, 'isDisplayed', 'id');\n}],\n// Cookie management.\n[cmd.Name.GET_ALL_COOKIES, get('/session/:sessionId/cookie')], [cmd.Name.ADD_COOKIE, post('/session/:sessionId/cookie')], [cmd.Name.DELETE_ALL_COOKIES, del('/session/:sessionId/cookie')], [cmd.Name.GET_COOKIE, get('/session/:sessionId/cookie/:name')], [cmd.Name.DELETE_COOKIE, del('/session/:sessionId/cookie/:name')],\n// Alert management.\n[cmd.Name.ACCEPT_ALERT, post('/session/:sessionId/alert/accept')], [cmd.Name.DISMISS_ALERT, post('/session/:sessionId/alert/dismiss')], [cmd.Name.GET_ALERT_TEXT, get('/session/:sessionId/alert/text')], [cmd.Name.SET_ALERT_TEXT, post('/session/:sessionId/alert/text')],\n// Screenshots.\n[cmd.Name.SCREENSHOT, get('/session/:sessionId/screenshot')], [cmd.Name.TAKE_ELEMENT_SCREENSHOT, get('/session/:sessionId/element/:id/screenshot')],\n// Shadow Root\n[cmd.Name.GET_SHADOW_ROOT, get('/session/:sessionId/element/:id/shadow')], [cmd.Name.FIND_ELEMENT_FROM_SHADOWROOT, post('/session/:sessionId/shadow/:id/element')], [cmd.Name.FIND_ELEMENTS_FROM_SHADOWROOT, post('/session/:sessionId/shadow/:id/elements')],\n// Log extensions.\n[cmd.Name.GET_LOG, post('/session/:sessionId/se/log')], [cmd.Name.GET_AVAILABLE_LOG_TYPES, get('/session/:sessionId/se/log/types')],\n// Server Extensions\n[cmd.Name.UPLOAD_FILE, post('/session/:sessionId/se/file')],\n// Virtual Authenticator\n[cmd.Name.ADD_VIRTUAL_AUTHENTICATOR, post('/session/:sessionId/webauthn/authenticator')], [cmd.Name.REMOVE_VIRTUAL_AUTHENTICATOR, del('/session/:sessionId/webauthn/authenticator/:authenticatorId')], [cmd.Name.ADD_CREDENTIAL, post('/session/:sessionId/webauthn/authenticator/:authenticatorId/credential')], [cmd.Name.GET_CREDENTIALS, get('/session/:sessionId/webauthn/authenticator/:authenticatorId/credentials')], [cmd.Name.REMOVE_CREDENTIAL, del('/session/:sessionId/webauthn/authenticator/:authenticatorId/credentials/:credentialId')], [cmd.Name.REMOVE_ALL_CREDENTIALS, del('/session/:sessionId/webauthn/authenticator/:authenticatorId/credentials')], [cmd.Name.SET_USER_VERIFIED, post('/session/:sessionId/webauthn/authenticator/:authenticatorId/uv')]]);\n\n/**\n * Handles sending HTTP messages to a remote end.\n *\n * @interface\n */\nclass Client {\n  /**\n   * Sends a request to the server. The client will automatically follow any\n   * redirects returned by the server, fulfilling the returned promise with the\n   * final response.\n   *\n   * @param {!Request} httpRequest The request to send.\n   * @return {!Promise<Response>} A promise that will be fulfilled with the\n   *     server's response.\n   */\n  send(httpRequest) {} // eslint-disable-line\n}\n\n/**\n * @param {Map<string, CommandSpec>} customCommands\n *     A map of custom command definitions.\n * @param {!cmd.Command} command The command to resolve.\n * @return {!Request} A promise that will resolve with the\n *     command to execute.\n */\nfunction buildRequest(customCommands, command) {\n  LOG.finest(() => `Translating command: ${command.getName()}`);\n  let spec = customCommands && customCommands.get(command.getName());\n  if (spec) {\n    return toHttpRequest(spec);\n  }\n  spec = W3C_COMMAND_MAP.get(command.getName());\n  if (typeof spec === 'function') {\n    LOG.finest(() => `Transforming command for W3C: ${command.getName()}`);\n    let newCommand = spec(command);\n    return buildRequest(customCommands, newCommand);\n  } else if (spec) {\n    return toHttpRequest(spec);\n  }\n  throw new error.UnknownCommandError('Unrecognized command: ' + command.getName());\n\n  /**\n   * @param {CommandSpec} resource\n   * @return {!Request}\n   */\n  function toHttpRequest(resource) {\n    LOG.finest(() => `Building HTTP request: ${JSON.stringify(resource)}`);\n    let parameters = command.getParameters();\n    let path = buildPath(resource.path, parameters);\n    return new Request(resource.method, path, parameters);\n  }\n}\nconst CLIENTS = /** !WeakMap<!Executor, !(Client|IThenable<!Client>)> */new WeakMap();\n\n/**\n * A command executor that communicates with the server using JSON over HTTP.\n *\n * By default, each instance of this class will use the legacy wire protocol\n * from [Selenium project][json]. The executor will automatically switch to the\n * [W3C wire protocol][w3c] if the remote end returns a compliant response to\n * a new session command.\n *\n * [json]: https://github.com/SeleniumHQ/selenium/wiki/JsonWireProtocol\n * [w3c]: https://w3c.github.io/webdriver/webdriver-spec.html\n *\n * @implements {cmd.Executor}\n */\nclass Executor {\n  /**\n   * @param {!(Client|IThenable<!Client>)} client The client to use for sending\n   *     requests to the server, or a promise-like object that will resolve\n   *     to the client.\n   */\n  constructor(client) {\n    CLIENTS.set(this, client);\n\n    /** @private {Map<string, CommandSpec>} */\n    this.customCommands_ = null;\n\n    /** @private {!logging.Logger} */\n    this.log_ = logging.getLogger('webdriver.http.Executor');\n  }\n\n  /**\n   * Defines a new command for use with this executor. When a command is sent,\n   * the {@code path} will be preprocessed using the command's parameters; any\n   * path segments prefixed with \":\" will be replaced by the parameter of the\n   * same name. For example, given \"/person/:name\" and the parameters\n   * \"{name: 'Bob'}\", the final command path will be \"/person/Bob\".\n   *\n   * @param {string} name The command name.\n   * @param {string} method The HTTP method to use when sending this command.\n   * @param {string} path The path to send the command to, relative to\n   *     the WebDriver server's command root and of the form\n   *     \"/path/:variable/segment\".\n   */\n  defineCommand(name, method, path) {\n    if (!this.customCommands_) {\n      this.customCommands_ = new Map();\n    }\n    this.customCommands_.set(name, {\n      method,\n      path\n    });\n  }\n\n  /** @override */\n  async execute(command) {\n    let request = buildRequest(this.customCommands_, command);\n    this.log_.finer(() => `>>> ${request.method} ${request.path}`);\n    let client = CLIENTS.get(this);\n    if (promise.isPromise(client)) {\n      client = await client;\n      CLIENTS.set(this, client);\n    }\n    let response = await client.send(request);\n    this.log_.finer(() => `>>>\\n${request}\\n<<<\\n${response}`);\n    let httpResponse = /** @type {!Response} */response;\n    let {\n      isW3C,\n      value\n    } = parseHttpResponse(command, httpResponse);\n    if (command.getName() === cmd.Name.NEW_SESSION) {\n      if (!value || !value.sessionId) {\n        throw new error.WebDriverError(`Unable to parse new session response: ${response.body}`);\n      }\n\n      // The remote end is a W3C compliant server if there is no `status`\n      // field in the response.\n      if (command.getName() === cmd.Name.NEW_SESSION) {\n        this.w3c = this.w3c || isW3C;\n      }\n\n      // No implementations use the `capabilities` key yet...\n      let capabilities = value.capabilities || value.value;\n      return new Session( /** @type {{sessionId: string}} */value.sessionId, capabilities);\n    }\n    return typeof value === 'undefined' ? null : value;\n  }\n}\n\n/**\n * @param {string} str .\n * @return {?} .\n */\nfunction tryParse(str) {\n  try {\n    return JSON.parse(str);\n  } catch (ignored) {\n    // Do nothing.\n  }\n}\n\n/**\n * Callback used to parse {@link Response} objects from a\n * {@link HttpClient}.\n *\n * @param {!cmd.Command} command The command the response is for.\n * @param {!Response} httpResponse The HTTP response to parse.\n * @return {{isW3C: boolean, value: ?}} An object describing the parsed\n *     response. This object will have two fields: `isW3C` indicates whether\n *     the response looks like it came from a remote end that conforms with the\n *     W3C WebDriver spec, and `value`, the actual response value.\n * @throws {WebDriverError} If the HTTP response is an error.\n */\nfunction parseHttpResponse(command, httpResponse) {\n  if (httpResponse.status < 200) {\n    // This should never happen, but throw the raw response so users report it.\n    throw new error.WebDriverError(`Unexpected HTTP response:\\n${httpResponse}`);\n  }\n  let parsed = tryParse(httpResponse.body);\n  if (parsed && typeof parsed === 'object') {\n    let value = parsed.value;\n    let isW3C = isObject(value) && typeof parsed.status === 'undefined';\n    if (!isW3C) {\n      error.checkLegacyResponse(parsed);\n\n      // Adjust legacy new session responses to look like W3C to simplify\n      // later processing.\n      if (command.getName() === cmd.Name.NEW_SESSION) {\n        value = parsed;\n      }\n    } else if (httpResponse.status > 399) {\n      error.throwDecodedError(value);\n    }\n    return {\n      isW3C,\n      value\n    };\n  }\n  if (parsed !== undefined) {\n    return {\n      isW3C: false,\n      value: parsed\n    };\n  }\n  let value = httpResponse.body.replace(/\\r\\n/g, '\\n');\n\n  // 404 represents an unknown command; anything else > 399 is a generic unknown\n  // error.\n  if (httpResponse.status === 404) {\n    throw new error.UnsupportedOperationError(command.getName() + ': ' + value);\n  } else if (httpResponse.status >= 400) {\n    throw new error.WebDriverError(value);\n  }\n  return {\n    isW3C: false,\n    value: value || null\n  };\n}\n\n/**\n * Builds a fully qualified path using the given set of command parameters. Each\n * path segment prefixed with ':' will be replaced by the value of the\n * corresponding parameter. All parameters spliced into the path will be\n * removed from the parameter map.\n * @param {string} path The original resource path.\n * @param {!Object<*>} parameters The parameters object to splice into the path.\n * @return {string} The modified path.\n */\nfunction buildPath(path, parameters) {\n  let pathParameters = path.match(/\\/:(\\w+)\\b/g);\n  if (pathParameters) {\n    for (let i = 0; i < pathParameters.length; ++i) {\n      let key = pathParameters[i].substring(2); // Trim the /:\n      if (key in parameters) {\n        let value = parameters[key];\n        if (webElement.isId(value)) {\n          // When inserting a WebElement into the URL, only use its ID value,\n          // not the full JSON.\n          value = webElement.extractId(value);\n        }\n        path = path.replace(pathParameters[i], '/' + value);\n        delete parameters[key];\n      } else {\n        throw new error.InvalidArgumentError('Missing required parameter: ' + key);\n      }\n    }\n  }\n  return path;\n}\n\n// PUBLIC API\n\nmodule.exports = {\n  Executor,\n  Client,\n  Request,\n  Response,\n  // Exported for testing.\n  buildPath\n};","map":{"version":3,"names":["path","require","cmd","error","logging","promise","Session","webElement","isObject","getAttribute","requireAtom","isDisplayed","findElements","module","bazelTarget","ex","file","slice","replace","console","log","resolve","ex2","Error","headersToString","headers","ret","forEach","value","name","push","toLowerCase","join","Request","constructor","method","opt_data","data","Map","toString","JSON","stringify","Response","status","body","header","set","Atom","GET_ATTRIBUTE","IS_DISPLAYED","FIND_ELEMENTS","LOG","getLogger","post","resource","del","get","CommandSpec","CommandTransformer","InternalTypeError","TypeError","toExecuteAtomCommand","command","atom","_len","arguments","length","params","Array","_key","Command","Name","EXECUTE_SCRIPT","setParameter","getParameter","map","param","W3C_COMMAND_MAP","NEW_SESSION","QUIT","GET_SERVER_STATUS","GET_TIMEOUT","SET_TIMEOUT","GET_CURRENT_URL","GET","GO_BACK","GO_FORWARD","REFRESH","GET_PAGE_SOURCE","GET_TITLE","EXECUTE_ASYNC_SCRIPT","SWITCH_TO_FRAME","SWITCH_TO_FRAME_PARENT","GET_CURRENT_WINDOW_HANDLE","CLOSE","SWITCH_TO_WINDOW","SWITCH_TO_NEW_WINDOW","GET_WINDOW_HANDLES","GET_WINDOW_RECT","SET_WINDOW_RECT","MAXIMIZE_WINDOW","MINIMIZE_WINDOW","FULLSCREEN_WINDOW","ACTIONS","CLEAR_ACTIONS","PRINT_PAGE","GET_ACTIVE_ELEMENT","FIND_ELEMENT","FIND_ELEMENTS_RELATIVE","FIND_CHILD_ELEMENT","FIND_CHILD_ELEMENTS","GET_ELEMENT_TAG_NAME","GET_DOM_ATTRIBUTE","GET_ELEMENT_ATTRIBUTE","GET_ELEMENT_PROPERTY","GET_ELEMENT_VALUE_OF_CSS_PROPERTY","GET_ELEMENT_RECT","CLEAR_ELEMENT","CLICK_ELEMENT","SEND_KEYS_TO_ELEMENT","GET_ELEMENT_TEXT","GET_COMPUTED_ROLE","GET_COMPUTED_LABEL","IS_ELEMENT_ENABLED","IS_ELEMENT_SELECTED","IS_ELEMENT_DISPLAYED","GET_ALL_COOKIES","ADD_COOKIE","DELETE_ALL_COOKIES","GET_COOKIE","DELETE_COOKIE","ACCEPT_ALERT","DISMISS_ALERT","GET_ALERT_TEXT","SET_ALERT_TEXT","SCREENSHOT","TAKE_ELEMENT_SCREENSHOT","GET_SHADOW_ROOT","FIND_ELEMENT_FROM_SHADOWROOT","FIND_ELEMENTS_FROM_SHADOWROOT","GET_LOG","GET_AVAILABLE_LOG_TYPES","UPLOAD_FILE","ADD_VIRTUAL_AUTHENTICATOR","REMOVE_VIRTUAL_AUTHENTICATOR","ADD_CREDENTIAL","GET_CREDENTIALS","REMOVE_CREDENTIAL","REMOVE_ALL_CREDENTIALS","SET_USER_VERIFIED","Client","send","httpRequest","buildRequest","customCommands","finest","getName","spec","toHttpRequest","newCommand","UnknownCommandError","parameters","getParameters","buildPath","CLIENTS","WeakMap","Executor","client","customCommands_","log_","defineCommand","execute","request","finer","isPromise","response","httpResponse","isW3C","parseHttpResponse","sessionId","WebDriverError","w3c","capabilities","tryParse","str","parse","ignored","parsed","checkLegacyResponse","throwDecodedError","undefined","UnsupportedOperationError","pathParameters","match","i","key","substring","isId","extractId","InvalidArgumentError","exports"],"sources":["/Users/Shared/ATS Git/ATSDemo/ReactJs/ReactCaseStudy/my-app/node_modules/selenium-webdriver/lib/http.js"],"sourcesContent":["// Licensed to the Software Freedom Conservancy (SFC) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The SFC licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\n/**\n * @fileoverview Defines an environment agnostic {@linkplain cmd.Executor\n * command executor} that communicates with a remote end using JSON over HTTP.\n *\n * Clients should implement the {@link Client} interface, which is used by\n * the {@link Executor} to send commands to the remote end.\n */\n\n'use strict'\n\nconst path = require('path')\nconst cmd = require('./command')\nconst error = require('./error')\nconst logging = require('./logging')\nconst promise = require('./promise')\nconst { Session } = require('./session')\nconst webElement = require('./webelement')\nconst { isObject } = require('./util')\n\nconst getAttribute = requireAtom(\n  'get-attribute.js',\n  '//javascript/node/selenium-webdriver/lib/atoms:get-attribute.js'\n)\nconst isDisplayed = requireAtom(\n  'is-displayed.js',\n  '//javascript/node/selenium-webdriver/lib/atoms:is-displayed.js'\n)\nconst findElements = requireAtom(\n  'find-elements.js',\n  '//javascript/node/selenium-webdriver/lib/atoms:find-elements.js'\n)\n\n/**\n * @param {string} module\n * @param {string} bazelTarget\n * @return {!Function}\n */\nfunction requireAtom(module, bazelTarget) {\n  try {\n    return require('./atoms/' + module)\n  } catch (ex) {\n    try {\n      const file = bazelTarget.slice(2).replace(':', '/')\n      console.log(`../../../bazel-bin/${file}`)\n      return require(path.resolve(`../../../bazel-bin/${file}`))\n    } catch (ex2) {\n      console.log(ex2)\n      throw Error(\n        `Failed to import atoms module ${module}. If running in dev mode, you` +\n          ` need to run \\`bazel build ${bazelTarget}\\` from the project` +\n          `root: ${ex}`\n      )\n    }\n  }\n}\n\n/**\n * Converts a headers map to a HTTP header block string.\n * @param {!Map<string, string>} headers The map to convert.\n * @return {string} The headers as a string.\n */\nfunction headersToString(headers) {\n  const ret = []\n  headers.forEach(function (value, name) {\n    ret.push(`${name.toLowerCase()}: ${value}`)\n  })\n  return ret.join('\\n')\n}\n\n/**\n * Represents a HTTP request message. This class is a \"partial\" request and only\n * defines the path on the server to send a request to. It is each client's\n * responsibility to build the full URL for the final request.\n * @final\n */\nclass Request {\n  /**\n   * @param {string} method The HTTP method to use for the request.\n   * @param {string} path The path on the server to send the request to.\n   * @param {Object=} opt_data This request's non-serialized JSON payload data.\n   */\n  constructor(method, path, opt_data) {\n    this.method = /** string */ method\n    this.path = /** string */ path\n    this.data = /** Object */ opt_data\n    this.headers = /** !Map<string, string> */ new Map([\n      ['Accept', 'application/json; charset=utf-8'],\n    ])\n  }\n\n  /** @override */\n  toString() {\n    let ret = `${this.method} ${this.path} HTTP/1.1\\n`\n    ret += headersToString(this.headers) + '\\n\\n'\n    if (this.data) {\n      ret += JSON.stringify(this.data)\n    }\n    return ret\n  }\n}\n\n/**\n * Represents a HTTP response message.\n * @final\n */\nclass Response {\n  /**\n   * @param {number} status The response code.\n   * @param {!Object<string>} headers The response headers. All header names\n   *     will be converted to lowercase strings for consistent lookups.\n   * @param {string} body The response body.\n   */\n  constructor(status, headers, body) {\n    this.status = /** number */ status\n    this.body = /** string */ body\n    this.headers = /** !Map<string, string>*/ new Map()\n    for (let header in headers) {\n      this.headers.set(header.toLowerCase(), headers[header])\n    }\n  }\n\n  /** @override */\n  toString() {\n    let ret = `HTTP/1.1 ${this.status}\\n${headersToString(this.headers)}\\n\\n`\n    if (this.body) {\n      ret += this.body\n    }\n    return ret\n  }\n}\n\n/** @enum {!Function} */\nconst Atom = {\n  GET_ATTRIBUTE: getAttribute,\n  IS_DISPLAYED: isDisplayed,\n  FIND_ELEMENTS: findElements,\n}\n\nconst LOG = logging.getLogger('webdriver.http')\n\nfunction post(path) {\n  return resource('POST', path)\n}\nfunction del(path) {\n  return resource('DELETE', path)\n}\nfunction get(path) {\n  return resource('GET', path)\n}\nfunction resource(method, path) {\n  return { method: method, path: path }\n}\n\n/** @typedef {{method: string, path: string}} */\nvar CommandSpec // eslint-disable-line\n\n/** @typedef {function(!cmd.Command): !cmd.Command} */\nvar CommandTransformer // eslint-disable-line\n\nclass InternalTypeError extends TypeError {}\n\n/**\n * @param {!cmd.Command} command The initial command.\n * @param {Atom} atom The name of the atom to execute.\n * @param params\n * @return {!Command} The transformed command to execute.\n */\nfunction toExecuteAtomCommand(command, atom, name, ...params) {\n  if (typeof atom !== 'function') {\n    throw new InternalTypeError('atom is not a function: ' + typeof atom)\n  }\n\n  return new cmd.Command(cmd.Name.EXECUTE_SCRIPT)\n    .setParameter('sessionId', command.getParameter('sessionId'))\n    .setParameter(\n      'script',\n      `/* ${name} */return (${atom}).apply(null, arguments)`\n    )\n    .setParameter(\n      'args',\n      params.map((param) => command.getParameter(param))\n    )\n}\n\n/** @const {!Map<string, (CommandSpec|CommandTransformer)>} */\nconst W3C_COMMAND_MAP = new Map([\n  // Session management.\n  [cmd.Name.NEW_SESSION, post('/session')],\n  [cmd.Name.QUIT, del('/session/:sessionId')],\n\n  // Server status.\n  [cmd.Name.GET_SERVER_STATUS, get('/status')],\n\n  // timeouts\n  [cmd.Name.GET_TIMEOUT, get('/session/:sessionId/timeouts')],\n  [cmd.Name.SET_TIMEOUT, post('/session/:sessionId/timeouts')],\n\n  // Navigation.\n  [cmd.Name.GET_CURRENT_URL, get('/session/:sessionId/url')],\n  [cmd.Name.GET, post('/session/:sessionId/url')],\n  [cmd.Name.GO_BACK, post('/session/:sessionId/back')],\n  [cmd.Name.GO_FORWARD, post('/session/:sessionId/forward')],\n  [cmd.Name.REFRESH, post('/session/:sessionId/refresh')],\n\n  // Page inspection.\n  [cmd.Name.GET_PAGE_SOURCE, get('/session/:sessionId/source')],\n  [cmd.Name.GET_TITLE, get('/session/:sessionId/title')],\n\n  // Script execution.\n  [cmd.Name.EXECUTE_SCRIPT, post('/session/:sessionId/execute/sync')],\n  [cmd.Name.EXECUTE_ASYNC_SCRIPT, post('/session/:sessionId/execute/async')],\n\n  // Frame selection.\n  [cmd.Name.SWITCH_TO_FRAME, post('/session/:sessionId/frame')],\n  [cmd.Name.SWITCH_TO_FRAME_PARENT, post('/session/:sessionId/frame/parent')],\n\n  // Window management.\n  [cmd.Name.GET_CURRENT_WINDOW_HANDLE, get('/session/:sessionId/window')],\n  [cmd.Name.CLOSE, del('/session/:sessionId/window')],\n  [cmd.Name.SWITCH_TO_WINDOW, post('/session/:sessionId/window')],\n  [cmd.Name.SWITCH_TO_NEW_WINDOW, post('/session/:sessionId/window/new')],\n  [cmd.Name.GET_WINDOW_HANDLES, get('/session/:sessionId/window/handles')],\n  [cmd.Name.GET_WINDOW_RECT, get('/session/:sessionId/window/rect')],\n  [cmd.Name.SET_WINDOW_RECT, post('/session/:sessionId/window/rect')],\n  [cmd.Name.MAXIMIZE_WINDOW, post('/session/:sessionId/window/maximize')],\n  [cmd.Name.MINIMIZE_WINDOW, post('/session/:sessionId/window/minimize')],\n  [cmd.Name.FULLSCREEN_WINDOW, post('/session/:sessionId/window/fullscreen')],\n\n  // Actions.\n  [cmd.Name.ACTIONS, post('/session/:sessionId/actions')],\n  [cmd.Name.CLEAR_ACTIONS, del('/session/:sessionId/actions')],\n  [cmd.Name.PRINT_PAGE, post('/session/:sessionId/print')],\n\n  // Locating elements.\n  [cmd.Name.GET_ACTIVE_ELEMENT, get('/session/:sessionId/element/active')],\n  [cmd.Name.FIND_ELEMENT, post('/session/:sessionId/element')],\n  [cmd.Name.FIND_ELEMENTS, post('/session/:sessionId/elements')],\n  [\n    cmd.Name.FIND_ELEMENTS_RELATIVE,\n    (cmd) => {\n      return toExecuteAtomCommand(\n        cmd,\n        Atom.FIND_ELEMENTS,\n        'findElements',\n        'args'\n      )\n    },\n  ],\n  [\n    cmd.Name.FIND_CHILD_ELEMENT,\n    post('/session/:sessionId/element/:id/element'),\n  ],\n  [\n    cmd.Name.FIND_CHILD_ELEMENTS,\n    post('/session/:sessionId/element/:id/elements'),\n  ],\n  // Element interaction.\n  [cmd.Name.GET_ELEMENT_TAG_NAME, get('/session/:sessionId/element/:id/name')],\n  [\n    cmd.Name.GET_DOM_ATTRIBUTE,\n    get('/session/:sessionId/element/:id/attribute/:name'),\n  ],\n  [\n    cmd.Name.GET_ELEMENT_ATTRIBUTE,\n    (cmd) => {\n      return toExecuteAtomCommand(\n        cmd,\n        Atom.GET_ATTRIBUTE,\n        'getAttribute',\n        'id',\n        'name'\n      )\n    },\n  ],\n  [\n    cmd.Name.GET_ELEMENT_PROPERTY,\n    get('/session/:sessionId/element/:id/property/:name'),\n  ],\n  [\n    cmd.Name.GET_ELEMENT_VALUE_OF_CSS_PROPERTY,\n    get('/session/:sessionId/element/:id/css/:propertyName'),\n  ],\n  [cmd.Name.GET_ELEMENT_RECT, get('/session/:sessionId/element/:id/rect')],\n  [cmd.Name.CLEAR_ELEMENT, post('/session/:sessionId/element/:id/clear')],\n  [cmd.Name.CLICK_ELEMENT, post('/session/:sessionId/element/:id/click')],\n  [\n    cmd.Name.SEND_KEYS_TO_ELEMENT,\n    post('/session/:sessionId/element/:id/value'),\n  ],\n  [cmd.Name.GET_ELEMENT_TEXT, get('/session/:sessionId/element/:id/text')],\n  [\n    cmd.Name.GET_COMPUTED_ROLE,\n    get('/session/:sessionId/element/:id/computedrole'),\n  ],\n  [\n    cmd.Name.GET_COMPUTED_LABEL,\n    get('/session/:sessionId/element/:id/computedlabel'),\n  ],\n  [cmd.Name.IS_ELEMENT_ENABLED, get('/session/:sessionId/element/:id/enabled')],\n  [\n    cmd.Name.IS_ELEMENT_SELECTED,\n    get('/session/:sessionId/element/:id/selected'),\n  ],\n\n  [\n    cmd.Name.IS_ELEMENT_DISPLAYED,\n    (cmd) => {\n      return toExecuteAtomCommand(cmd, Atom.IS_DISPLAYED, 'isDisplayed', 'id')\n    },\n  ],\n\n  // Cookie management.\n  [cmd.Name.GET_ALL_COOKIES, get('/session/:sessionId/cookie')],\n  [cmd.Name.ADD_COOKIE, post('/session/:sessionId/cookie')],\n  [cmd.Name.DELETE_ALL_COOKIES, del('/session/:sessionId/cookie')],\n  [cmd.Name.GET_COOKIE, get('/session/:sessionId/cookie/:name')],\n  [cmd.Name.DELETE_COOKIE, del('/session/:sessionId/cookie/:name')],\n\n  // Alert management.\n  [cmd.Name.ACCEPT_ALERT, post('/session/:sessionId/alert/accept')],\n  [cmd.Name.DISMISS_ALERT, post('/session/:sessionId/alert/dismiss')],\n  [cmd.Name.GET_ALERT_TEXT, get('/session/:sessionId/alert/text')],\n  [cmd.Name.SET_ALERT_TEXT, post('/session/:sessionId/alert/text')],\n\n  // Screenshots.\n  [cmd.Name.SCREENSHOT, get('/session/:sessionId/screenshot')],\n  [\n    cmd.Name.TAKE_ELEMENT_SCREENSHOT,\n    get('/session/:sessionId/element/:id/screenshot'),\n  ],\n\n  // Shadow Root\n  [cmd.Name.GET_SHADOW_ROOT, get('/session/:sessionId/element/:id/shadow')],\n  [\n    cmd.Name.FIND_ELEMENT_FROM_SHADOWROOT,\n    post('/session/:sessionId/shadow/:id/element'),\n  ],\n  [\n    cmd.Name.FIND_ELEMENTS_FROM_SHADOWROOT,\n    post('/session/:sessionId/shadow/:id/elements'),\n  ],\n  // Log extensions.\n  [cmd.Name.GET_LOG, post('/session/:sessionId/se/log')],\n  [cmd.Name.GET_AVAILABLE_LOG_TYPES, get('/session/:sessionId/se/log/types')],\n\n  // Server Extensions\n  [cmd.Name.UPLOAD_FILE, post('/session/:sessionId/se/file')],\n\n  // Virtual Authenticator\n  [\n    cmd.Name.ADD_VIRTUAL_AUTHENTICATOR,\n    post('/session/:sessionId/webauthn/authenticator'),\n  ],\n  [\n    cmd.Name.REMOVE_VIRTUAL_AUTHENTICATOR,\n    del('/session/:sessionId/webauthn/authenticator/:authenticatorId'),\n  ],\n  [\n    cmd.Name.ADD_CREDENTIAL,\n    post(\n      '/session/:sessionId/webauthn/authenticator/:authenticatorId/credential'\n    ),\n  ],\n  [\n    cmd.Name.GET_CREDENTIALS,\n    get(\n      '/session/:sessionId/webauthn/authenticator/:authenticatorId/credentials'\n    ),\n  ],\n  [\n    cmd.Name.REMOVE_CREDENTIAL,\n    del(\n      '/session/:sessionId/webauthn/authenticator/:authenticatorId/credentials/:credentialId'\n    ),\n  ],\n  [\n    cmd.Name.REMOVE_ALL_CREDENTIALS,\n    del(\n      '/session/:sessionId/webauthn/authenticator/:authenticatorId/credentials'\n    ),\n  ],\n  [\n    cmd.Name.SET_USER_VERIFIED,\n    post('/session/:sessionId/webauthn/authenticator/:authenticatorId/uv'),\n  ],\n])\n\n/**\n * Handles sending HTTP messages to a remote end.\n *\n * @interface\n */\nclass Client {\n  /**\n   * Sends a request to the server. The client will automatically follow any\n   * redirects returned by the server, fulfilling the returned promise with the\n   * final response.\n   *\n   * @param {!Request} httpRequest The request to send.\n   * @return {!Promise<Response>} A promise that will be fulfilled with the\n   *     server's response.\n   */\n  send(httpRequest) {} // eslint-disable-line\n}\n\n/**\n * @param {Map<string, CommandSpec>} customCommands\n *     A map of custom command definitions.\n * @param {!cmd.Command} command The command to resolve.\n * @return {!Request} A promise that will resolve with the\n *     command to execute.\n */\nfunction buildRequest(customCommands, command) {\n  LOG.finest(() => `Translating command: ${command.getName()}`)\n  let spec = customCommands && customCommands.get(command.getName())\n  if (spec) {\n    return toHttpRequest(spec)\n  }\n\n  spec = W3C_COMMAND_MAP.get(command.getName())\n  if (typeof spec === 'function') {\n    LOG.finest(() => `Transforming command for W3C: ${command.getName()}`)\n    let newCommand = spec(command)\n    return buildRequest(customCommands, newCommand)\n  } else if (spec) {\n    return toHttpRequest(spec)\n  }\n  throw new error.UnknownCommandError(\n    'Unrecognized command: ' + command.getName()\n  )\n\n  /**\n   * @param {CommandSpec} resource\n   * @return {!Request}\n   */\n  function toHttpRequest(resource) {\n    LOG.finest(() => `Building HTTP request: ${JSON.stringify(resource)}`)\n    let parameters = command.getParameters()\n    let path = buildPath(resource.path, parameters)\n    return new Request(resource.method, path, parameters)\n  }\n}\n\nconst CLIENTS =\n  /** !WeakMap<!Executor, !(Client|IThenable<!Client>)> */ new WeakMap()\n\n/**\n * A command executor that communicates with the server using JSON over HTTP.\n *\n * By default, each instance of this class will use the legacy wire protocol\n * from [Selenium project][json]. The executor will automatically switch to the\n * [W3C wire protocol][w3c] if the remote end returns a compliant response to\n * a new session command.\n *\n * [json]: https://github.com/SeleniumHQ/selenium/wiki/JsonWireProtocol\n * [w3c]: https://w3c.github.io/webdriver/webdriver-spec.html\n *\n * @implements {cmd.Executor}\n */\nclass Executor {\n  /**\n   * @param {!(Client|IThenable<!Client>)} client The client to use for sending\n   *     requests to the server, or a promise-like object that will resolve\n   *     to the client.\n   */\n  constructor(client) {\n    CLIENTS.set(this, client)\n\n    /** @private {Map<string, CommandSpec>} */\n    this.customCommands_ = null\n\n    /** @private {!logging.Logger} */\n    this.log_ = logging.getLogger('webdriver.http.Executor')\n  }\n\n  /**\n   * Defines a new command for use with this executor. When a command is sent,\n   * the {@code path} will be preprocessed using the command's parameters; any\n   * path segments prefixed with \":\" will be replaced by the parameter of the\n   * same name. For example, given \"/person/:name\" and the parameters\n   * \"{name: 'Bob'}\", the final command path will be \"/person/Bob\".\n   *\n   * @param {string} name The command name.\n   * @param {string} method The HTTP method to use when sending this command.\n   * @param {string} path The path to send the command to, relative to\n   *     the WebDriver server's command root and of the form\n   *     \"/path/:variable/segment\".\n   */\n  defineCommand(name, method, path) {\n    if (!this.customCommands_) {\n      this.customCommands_ = new Map()\n    }\n    this.customCommands_.set(name, { method, path })\n  }\n\n  /** @override */\n  async execute(command) {\n    let request = buildRequest(this.customCommands_, command)\n    this.log_.finer(() => `>>> ${request.method} ${request.path}`)\n\n    let client = CLIENTS.get(this)\n    if (promise.isPromise(client)) {\n      client = await client\n      CLIENTS.set(this, client)\n    }\n\n    let response = await client.send(request)\n    this.log_.finer(() => `>>>\\n${request}\\n<<<\\n${response}`)\n\n    let httpResponse = /** @type {!Response} */ (response)\n\n    let { isW3C, value } = parseHttpResponse(command, httpResponse)\n\n    if (command.getName() === cmd.Name.NEW_SESSION) {\n      if (!value || !value.sessionId) {\n        throw new error.WebDriverError(\n          `Unable to parse new session response: ${response.body}`\n        )\n      }\n\n      // The remote end is a W3C compliant server if there is no `status`\n      // field in the response.\n      if (command.getName() === cmd.Name.NEW_SESSION) {\n        this.w3c = this.w3c || isW3C\n      }\n\n      // No implementations use the `capabilities` key yet...\n      let capabilities = value.capabilities || value.value\n      return new Session(\n        /** @type {{sessionId: string}} */ (value).sessionId,\n        capabilities\n      )\n    }\n\n    return typeof value === 'undefined' ? null : value\n  }\n}\n\n/**\n * @param {string} str .\n * @return {?} .\n */\nfunction tryParse(str) {\n  try {\n    return JSON.parse(str)\n  } catch (ignored) {\n    // Do nothing.\n  }\n}\n\n/**\n * Callback used to parse {@link Response} objects from a\n * {@link HttpClient}.\n *\n * @param {!cmd.Command} command The command the response is for.\n * @param {!Response} httpResponse The HTTP response to parse.\n * @return {{isW3C: boolean, value: ?}} An object describing the parsed\n *     response. This object will have two fields: `isW3C` indicates whether\n *     the response looks like it came from a remote end that conforms with the\n *     W3C WebDriver spec, and `value`, the actual response value.\n * @throws {WebDriverError} If the HTTP response is an error.\n */\nfunction parseHttpResponse(command, httpResponse) {\n  if (httpResponse.status < 200) {\n    // This should never happen, but throw the raw response so users report it.\n    throw new error.WebDriverError(`Unexpected HTTP response:\\n${httpResponse}`)\n  }\n\n  let parsed = tryParse(httpResponse.body)\n\n  if (parsed && typeof parsed === 'object') {\n    let value = parsed.value\n    let isW3C = isObject(value) && typeof parsed.status === 'undefined'\n\n    if (!isW3C) {\n      error.checkLegacyResponse(parsed)\n\n      // Adjust legacy new session responses to look like W3C to simplify\n      // later processing.\n      if (command.getName() === cmd.Name.NEW_SESSION) {\n        value = parsed\n      }\n    } else if (httpResponse.status > 399) {\n      error.throwDecodedError(value)\n    }\n\n    return { isW3C, value }\n  }\n\n  if (parsed !== undefined) {\n    return { isW3C: false, value: parsed }\n  }\n\n  let value = httpResponse.body.replace(/\\r\\n/g, '\\n')\n\n  // 404 represents an unknown command; anything else > 399 is a generic unknown\n  // error.\n  if (httpResponse.status === 404) {\n    throw new error.UnsupportedOperationError(command.getName() + ': ' + value)\n  } else if (httpResponse.status >= 400) {\n    throw new error.WebDriverError(value)\n  }\n\n  return { isW3C: false, value: value || null }\n}\n\n/**\n * Builds a fully qualified path using the given set of command parameters. Each\n * path segment prefixed with ':' will be replaced by the value of the\n * corresponding parameter. All parameters spliced into the path will be\n * removed from the parameter map.\n * @param {string} path The original resource path.\n * @param {!Object<*>} parameters The parameters object to splice into the path.\n * @return {string} The modified path.\n */\nfunction buildPath(path, parameters) {\n  let pathParameters = path.match(/\\/:(\\w+)\\b/g)\n  if (pathParameters) {\n    for (let i = 0; i < pathParameters.length; ++i) {\n      let key = pathParameters[i].substring(2) // Trim the /:\n      if (key in parameters) {\n        let value = parameters[key]\n        if (webElement.isId(value)) {\n          // When inserting a WebElement into the URL, only use its ID value,\n          // not the full JSON.\n          value = webElement.extractId(value)\n        }\n        path = path.replace(pathParameters[i], '/' + value)\n        delete parameters[key]\n      } else {\n        throw new error.InvalidArgumentError(\n          'Missing required parameter: ' + key\n        )\n      }\n    }\n  }\n  return path\n}\n\n// PUBLIC API\n\nmodule.exports = {\n  Executor,\n  Client,\n  Request,\n  Response,\n  // Exported for testing.\n  buildPath,\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}